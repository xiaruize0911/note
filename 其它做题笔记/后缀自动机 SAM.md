SAM满足如下性质
1. 有向无环图 每个转移只有一个字符
2. 接受且只接受 $S$  的后缀
3. 节点数在满足上述条件下最小

考虑不满足性质 $3$，那么 $trie$ 就可以做到

将这个 $trie$ 建出来后，发现有很多完全相同的子树

定义 $endpos(s)$ 表示串 $s$ 在 $S$ 中所有匹配的结束位置的集合，对于所有的 $endpos(a)=endpos(b)$ ，可以考虑把这两个点合起来 **$endpos$ 的数量是 $\mathcal{O}(n)$ 的** ，可以发现每个集合都是由一个更大的集合划分得到的，形成一个树形结构，每个节点表示一个 $endpos$ ，一般将这个树称为 $parent\ tree$，这棵树在满二叉树时达到 $2n-1$ 个点

对于构建，维护 $nxt_{ch}$ 表示当前状态接受 $ch$ 后转移到的状态，$$