从大到小考虑将每个数加入当前的序列

$dp_{i,j}$ 表示 $[1,i]$ 全部加入后，$LISNumber=j$  的方案数

对于一个新的数，有 $x$ 个，枚举这个数加入的时候分为几段 $k$ ，再枚举其中有多少段 $cnt$ 加在一个极大递增序列后面

那么 $LISNumber$ 的变化量就是
$$
x-k+(k-cnt)
$$
达到这个的方案数为
$$
\binom{x-1}{k}\binom{j}{cnt}\binom{sum-j+1}{x-cnt}
$$